n1 = 32
n2 = n1
p = 4

y1 = matrix(c(1597,1591,2719,2275)/100); y1
y2 = matrix(c(1234,1391,1666,2194)/100); y2

S1 = matrix(c(5.192,4.545,6.522,5.250,4.545,13.18,6.76,6.266,6.522,6.76,28.67,14.47,5.25,6.266,14.47,16.65), ncol=4); S1
S2 = matrix(c(9.136,7.549,4.864,4.151,7.549,18.6,10.22,5.446,4.864,10.22,30.04,13.49,4.151,5.446,13.49,28), ncol=4); S2

Sp = ( (n1-1)*S1 + (n2-1)*S2 ) / (n1+n2-2); Sp

T2 = (n1*n2)/(n1+n2) * t(y1 - y2) %*% solve(Sp) %*% (y1 - y2); T2
Fcalc = T2 * (n1 + n2 - p - 1)/( (n1 + n2 - 2) *p ); Fcalc
Ftab = qf(1-0.01, p, n1+n2-p-1); Ftab
p_valor = pf(Fcalc, p, n1+n2-p-1, lower.tail = F); p_valor
T2tab = Ftab * 1/Fcalc * T2; T2tab
